<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>My Info</title>
</head>
<body>
    <h2>My Info</h2>
    <div id="result">Loading...</div>

    <script>
        async function getMyInfo() {
            const token = localStorage.getItem("token");
            
            if (!token) {
                document.getElementById("result").innerText = "No token found. Please sign in first.";
                return;
            }

            try {
                const res = await fetch("/me", {
                    method: "GET",
                    headers: { "Authorization": `Bearer ${token}` }
                });

                const data = await res.json();

                if (res.ok) {
                    document.getElementById("result").innerText = JSON.stringify(data, null, 2);
                } else {
                    document.getElementById("result").innerText = data.message || "Error fetching info.";
                }
            } catch (err) {
                document.getElementById("result").innerText = "Error: " + err.message;
            }
        }

        getMyInfo();
    </script>
</body>
</html>
